<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Capstone Report Generator</title>
    <meta name="description"
        content="Automated document formatter for Capstone Project reports - Full AI-powered project content generation">
    <meta name="google-site-verification" content="OXT5RJR3N7hQhhX5DurUwhIQ6WWk-hlVmmcYzuaxqfw" />
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Playfair+Display:wght@700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="./style.css">
    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>

    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        window.firebaseModules = { initializeApp, getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut, getFirestore, doc, setDoc, getDoc };
    </script>
</head>

<body>
    <!-- App Shell -->
    <div id="app-shell">
        <!-- Top Navigation -->
        <div class="top-nav">
            <div class="nav-left">
                <div class="logo-mini">CRG</div>
                <div class="nav-tabs">
                    <button class="nav-tab-btn active" onclick="switchTab('dashboard')"
                        id="tab-dashboard">Dashboard</button>
                    <button class="nav-tab-btn" onclick="switchTab('workstation')"
                        id="tab-workstation">Workstation</button>
                </div>
            </div>
            <div class="nav-right">
                <div class="welcome-text">Welcome, <span id="display-username">User</span></div>
                <div class="profile-widget" onclick="toggleProfileMenu()">
                    <div class="profile-info">
                        <div class="profile-name" id="widget-name">Student Name</div>
                        <div class="profile-meta"><span id="widget-year">IV</span> Year • <span
                                id="widget-dept">CSE</span></div>
                    </div>
                    <div class="profile-avatar">
                        <div class="avatar-circle">S</div>
                    </div>
                    <div class="profile-menu" id="profile-menu">
                        <button onclick="openProfileEdit()"><svg width="14" height="14" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2">
                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                            </svg> Edit Profile</button>
                        <button onclick="logout()"><svg width="14" height="14" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2">
                                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                                <polyline points="16 17 21 12 16 7"></polyline>
                                <line x1="21" y1="12" x2="9" y2="12"></line>
                            </svg> View Report History</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab Content -->
        <div id="dashboard-view" class="tab-view active">
            <!-- Dashboard Header -->
            <div class="dashboard-welcome">
                <div class="welcome-card">
                    <div class="card-glow"></div>
                    <div class="welcome-header">
                        <div class="badge-new">INSTITUTIONAL PORTAL</div>
                        <h1>Welcome to CRG – <br><span class="hero-accent">Capstone Report Generator</span></h1>
                        <p class="welcome-subtitle">Your intelligent academic workspace designed exclusively for SIMATS
                            students.</p>
                        <p class="welcome-submessage">Generate structured, domain-specific, university-ready project
                            reports in minutes.</p>
                    </div>

                    <div class="welcome-intro">
                        <p>CRG simplifies the process of preparing comprehensive capstone reports across all engineering
                            and interdisciplinary domains. From abstract to conclusion, our system generates
                            well-structured, academically formatted documentation aligned with university standards.</p>
                        <p>Whether your project belongs to CSE, ECE, MECH, CIVIL, AI, or any emerging domain, CRG adapts
                            to your topic and delivers structured content instantly.</p>
                    </div>

                    <div class="feature-highlights">
                        <h2>What You Can Do Here</h2>
                        <ul class="feature-list">
                            <li><span>•</span> Generate complete 30-page academic reports</li>
                            <li><span>•</span> Customize domain, department, and project specifications</li>
                            <li><span>•</span> Export professionally formatted documents</li>
                            <li><span>•</span> Save and revisit previous reports</li>
                            <li><span>•</span> Edit and refine generated sections</li>
                        </ul>
                    </div>

                    <div class="academic-banner">
                        <div class="banner-title">Academic Private Cloud v1.0</div>
                        <p>A secure academic environment built exclusively for SIMATS Engineering students. Your data
                            and reports remain private and accessible only to you.</p>
                    </div>

                    <div class="profile-prompt">
                        <p>Complete your academic profile to personalize report formatting according to your department
                            and year of study.</p>
                        <button class="btn btn-ghost btn-sm" onclick="openProfileEdit()">Personalize Profile</button>
                    </div>

                    <div class="action-footer">
                        <button class="btn btn-primary btn-glow" onclick="switchTab('workstation')">
                            Get Started
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Project Context (From previous analysis) -->
                <div class="project-context-box">
                    <div class="context-label">PROJECT ANALYSIS CONTEXT</div>
                    <div class="context-content-wrapper">
                        <div class="context-snippet">
                            <h4>Institutional Standard Alignment</h4>
                            <p>Academic reports must strictly follow the Saveetha Institute guidelines: 0.89" Left
                                margin, 0.98" Right margin, and 14pt BOLD headings. Times New Roman font (12pt) is
                                mandatory for body text.</p>
                        </div>
                        <div class="context-snippet">
                            <h4>Reference Study: Cross-Platform VPN Testing</h4>
                            <p>Research focus includes OpenVPN, WireGuard, and IKEv2/IPSec protocols. Testing
                                methodology involves Phase 1 (Setup), Phase 2 (Performance), and Phase 3 (Security
                                Evaluation: DNS/IP Leak testing).</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="workstation-view" class="tab-view">
            <!-- Animated Background (Shared but only visible in workstation) -->
            <div class="bg-grid"></div>
            <div class="bg-glow bg-glow-1"></div>
            <div class="bg-glow bg-glow-2"></div>
            <div class="bg-glow bg-glow-3"></div>

            <div class="header-actions">
                <button id="theme-toggle" class="btn-icon" title="Toggle Theme">
                    <svg class="sun-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                    <svg class="moon-icon hidden" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                </button>
                <div class="header-badge">SIMATS Engineering <span class="v-tag-mini">v1.0</span></div>
            </div>

            <!-- Dynamic Layout: Input & Preview -->
            <div class="workspace-layout">
                <!-- Left Pane: Generator -->
                <main id="app-main" class="workspace-pane">
                    <!-- Hero Section -->
                    <section class="hero" id="hero-section">
                        <h1 class="hero-title">
                            <span class="hero-accent">Capstone</span>
                            Workstation <span class="v-tag">v1.0</span>
                        </h1>
                    </section>

                    <!-- Form Section -->
                    <section class="form-section" id="form-section">
                        <form id="project-form" autocomplete="off">
                            <!-- Step Indicator -->
                            <div class="step-indicator" id="step-indicator">
                                <div class="step active" data-step="1">
                                    <div class="step-number">1</div>
                                    <span>Project Info</span>
                                </div>
                                <div class="step-line"></div>
                                <div class="step" data-step="2">
                                    <div class="step-number">2</div>
                                    <span>Students</span>
                                </div>
                                <div class="step-line"></div>
                                <div class="step" data-step="3">
                                    <div class="step-number">3</div>
                                    <span>Guide & Dates</span>
                                </div>
                            </div>
                            <!-- REST OF THE FORM CONTENT WILL BE REPLACED BACK - I'll use multi_replace instead of write_to_file if possible but I already started this. Wait, I should probably just use multi_replace to be safe with the large file. -->