<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CWS (CAPSTONE WORK STATION) V1.0</title>
    <meta name="description"
        content="Automated document formatter for Capstone Project reports - Full AI-powered project content generation">
    <meta name="google-site-verification" content="OXT5RJR3N7hQhhX5DurUwhIQ6WWk-hlVmmcYzuaxqfw" />
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Playfair+Display:wght@700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="./style.css">
    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
    <!-- Global Script Entry -->
    <!-- Global Script Entry -->
    <script type="module" src="./main.js"></script>
    <script>
        // Global proxies â€” switchTab is fully implemented inline to work before ES module loads
        window.switchTab = function (id) {
            if (window._switchTab) { window._switchTab(id); return; }
            // Immediate DOM fallback (no module needed)
            document.querySelectorAll('.tab-view').forEach(function (v) { v.classList.remove('active'); });
            document.querySelectorAll('.nav-tab-btn').forEach(function (b) { b.classList.remove('active'); });
            var view = document.getElementById(id + '-view');
            if (view) view.classList.add('active');
            var btn = document.getElementById('tab-' + id);
            if (btn) btn.classList.add('active');
        };
        window.toggleAuthMode = function () { if (window._toggleAuthMode) window._toggleAuthMode(); };
        window.logout = function () { if (window._logout) window._logout(); };
        window.openProfileEdit = function () { if (window._openProfileEdit) window._openProfileEdit(); };
        window.closeProfileModal = function () { if (window._closeProfileModal) window._closeProfileModal(); };
        window.toggleProfileMenu = function () { if (window._toggleProfileMenu) window._toggleProfileMenu(); };
    </script>
</head>

<body>
    <!-- Login Portal -->
    <div id="login-overlay" class="login-overlay">
        <div class="login-card">
            <div class="login-header">
                <div class="logo-circle">ðŸ“‘</div>
                <h1 id="auth-title">Student Login</h1>
                <p id="auth-desc">Access your 30-page report generator</p>
            </div>

            <form id="auth-form" class="auth-form">
                <div class="input-group">
                    <label>SIMATS Email</label>
                    <input type="email" id="auth-email" placeholder="e.g. 123456789.simats@saveetha.com" required>
                </div>
                <div class="input-group">
                    <label>Password</label>
                    <input type="password" id="auth-pass" placeholder="Your secret key" required>
                </div>

                <div id="register-extra-fields" style="display: none;">
                    <div class="input-group">
                        <label>Full Name</label>
                        <input type="text" id="auth-name" placeholder="e.g. John Doe">
                    </div>
                    <div class="input-group">
                        <label>Department</label>
                        <select id="auth-dept" class="input-select">
                            <option value="CSE">CSE (Computer Science)</option>
                            <option value="AI & DS">AI & DS</option>
                            <option value="ECE">ECE</option>
                            <option value="MECH">MECH</option>
                            <option value="CIVIL">CIVIL</option>
                            <option value="BME">BME</option>
                            <option value="IT">IT</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label>Year of Study</label>
                        <select id="auth-year" class="input-select">
                            <option value="I">I Year</option>
                            <option value="II">II Year</option>
                            <option value="III">III Year</option>
                            <option value="IV">IV Year</option>
                        </select>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary btn-full">
                    <span id="auth-btn-text">Sign In</span>
                </button>
            </form>


            <div class="auth-footer">
                <p class="forgot-pass" id="toggle-auth">Register Now?</p>
            </div>
        </div>
    </div>

    <!-- Profile Setup / Edit Modal -->
    <!-- data-mandatory="true" = cannot be dismissed, shown on first login -->
    <div id="profile-modal" class="profile-edit-modal" data-mandatory="false">
        <div class="login-card profile-modal-card">
            <div class="login-header">
                <div class="simats-logo-circle" id="prof-modal-icon">ðŸ‘¤</div>
                <h2 id="prof-modal-title">Complete Your Profile</h2>
                <p id="prof-modal-desc">This information is shown on your dashboard and reports</p>
            </div>

            <!-- First-time setup notice (shown only when mandatory) -->
            <div class="profile-first-notice" id="prof-first-notice">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10" />
                    <path d="M12 16v-4" />
                    <path d="M12 8h.01" />
                </svg>
                Fill in your name, department and year â€” this appears on your dashboard.
            </div>

            <form id="profile-form" class="auth-form">
                <div class="input-group">
                    <label>Full Name <span style="color:var(--danger)">*</span></label>
                    <input type="text" id="prof-name" placeholder="e.g. Arjun Kumar" required autocomplete="name">
                </div>
                <div class="input-group">
                    <label>Department <span style="color:var(--danger)">*</span></label>
                    <select id="prof-dept" class="input-select" required>
                        <option value="">â€” Select Department â€”</option>
                        <option value="CSE">CSE (Computer Science)</option>
                        <option value="AI &amp; DS">AI &amp; DS</option>
                        <option value="ECE">ECE (Electronics)</option>
                        <option value="MECH">MECH (Mechanical)</option>
                        <option value="CIVIL">CIVIL (Civil Engineering)</option>
                        <option value="BME">BME (Biomedical)</option>
                        <option value="IT">IT (Information Technology)</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Year of Study <span style="color:var(--danger)">*</span></label>
                    <select id="prof-year" class="input-select" required>
                        <option value="">â€” Select Year â€”</option>
                        <option value="I">I Year</option>
                        <option value="II">II Year</option>
                        <option value="III">III Year</option>
                        <option value="IV">IV Year</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary btn-full" id="prof-save-btn">
                    Save &amp; Continue
                </button>
                <!-- Cancel only shown for edits, not first-time setup -->
                <button type="button" class="btn btn-ghost btn-full" id="prof-cancel-btn"
                    style="margin-top:0.5rem; display:none;" onclick="window.closeProfileModal()">
                    Cancel
                </button>
            </form>
        </div>
    </div>

    <!-- App Shell -->
    <div id="app-shell" class="app-hidden">
        <!-- Top Navigation / Profile -->
        <div class="top-nav">
            <div class="nav-left">
                <div class="logo-mini">CWS</div>
                <!-- Tab Buttons â€” NO onclick, handled by tabs.js event listeners -->
                <div class="nav-tabs">
                    <button class="nav-tab-btn active" id="tab-dashboard" data-tab="dashboard">Dashboard</button>
                    <button class="nav-tab-btn" id="tab-workstation" data-tab="workstation">Capstone
                        Workstation</button>
                </div>
            </div>
            <div class="nav-right">
                <div class="welcome-text">Welcome, <span id="display-studentId">--</span></div>
                <div class="profile-widget">
                    <div class="profile-info">
                        <div class="profile-name" id="widget-name">--</div>
                        <div class="profile-meta" id="widget-meta" style="display:none;"></div>
                    </div>
                    <div class="profile-avatar">
                        <div class="avatar-circle">?</div>
                    </div>
                    <div class="profile-menu" id="profile-menu">
                        <button id="btn-edit-profile"><svg width="14" height="14" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2">
                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                            </svg> Edit Profile</button>
                        <button id="btn-logout"><svg width="14" height="14" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2">
                                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                                <polyline points="16 17 21 12 16 7"></polyline>
                                <line x1="21" y1="12" x2="9" y2="12"></line>
                            </svg> Logout</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!--  DASHBOARD TAB VIEW                            -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div id="dashboard-view" class="tab-view">
            <div class="dashboard-welcome">
                <div class="welcome-card">
                    <div class="card-glow"></div>
                    <div class="welcome-header">
                        <div class="badge-new">INSTITUTIONAL PORTAL</div>
                        <h1>Welcome to CWS,<br><span id="dash-student-name" class="hero-accent">--</span></h1>
                        <p class="welcome-student-meta">
                            <span id="dash-reg-no">--</span>
                            &nbsp;|&nbsp;
                            <span id="dash-year">--</span>
                            &nbsp;|&nbsp;
                            <span id="dash-dept">--</span>
                        </p>
                        <p class="welcome-subtitle">Your intelligent academic workspace designed exclusively for SIMATS
                            students.</p>
                    </div>

                    <div class="welcome-intro">
                        <p>CWS simplifies the process of preparing comprehensive capstone reports across all engineering
                            and interdisciplinary domains. From abstract to conclusion, our system generates
                            well-structured, academically formatted documentation aligned with university standards.</p>
                        <p>Whether your project belongs to CSE, ECE, MECH, CIVIL, AI, or any emerging domain, CWS adapts
                            to your topic and delivers structured content instantly.</p>
                    </div>

                    <div class="feature-highlights">
                        <h2>What You Can Do Here</h2>
                        <ul class="feature-list">
                            <li><span>â€¢</span> Generate complete 30-page academic reports</li>
                            <li><span>â€¢</span> Customize domain, department, and project specifications</li>
                            <li><span>â€¢</span> Export professionally formatted documents</li>
                            <li><span>â€¢</span> Save and revisit previous reports</li>
                            <li><span>â€¢</span> Edit and refine generated sections</li>
                        </ul>
                    </div>

                    <div class="action-footer">
                        <button class="btn btn-primary btn-glow" id="btn-get-started">
                            Get Started
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!--  WORKSTATION TAB VIEW                          -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div id="workstation-view" class="tab-view">

            <!-- Animated Background (Shared) -->
            <div class="bg-grid"></div>
            <div class="bg-glow bg-glow-1"></div>
            <div class="bg-glow bg-glow-2"></div>
            <div class="bg-glow bg-glow-3"></div>

            <div class="header-actions">
                <button id="theme-toggle" class="btn-icon" title="Toggle Theme">
                    <svg class="sun-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                    <svg class="moon-icon hidden" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                </button>
                <div class="header-badge">SIMATS Engineering <span class="v-tag-mini">v1.0</span></div>
            </div>



            <!-- Dynamic Layout: Input & Preview -->
            <div class="workspace-layout">
                <!-- Left Pane: Generator -->
                <main id="app-main" class="workspace-pane">
                    <!-- Hero Section -->
                    <section class="hero" id="hero-section">
                        <h1 class="hero-title">
                            <span class="hero-accent">Capstone</span>
                            Workstation <span class="v-tag">v1.0</span>
                        </h1>
                    </section>

                    <!-- Form Section -->
                    <section class="form-section" id="form-section">
                        <form id="project-form" autocomplete="off">
                            <!-- Step Indicator -->
                            <div class="step-indicator" id="step-indicator">
                                <div class="step active" data-step="1">
                                    <div class="step-number">1</div>
                                    <span>Project Info</span>
                                </div>
                                <div class="step-line"></div>
                                <div class="step" data-step="2">
                                    <div class="step-number">2</div>
                                    <span>Students</span>
                                </div>
                                <div class="step-line"></div>
                                <div class="step" data-step="3">
                                    <div class="step-number">3</div>
                                    <span>Guide & Dates</span>
                                </div>
                            </div>

                            <!-- Step 1: Project Info -->
                            <div class="form-step active" id="step-1">
                                <div class="card">
                                    <div class="card-header">
                                        <div class="card-icon">
                                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor" stroke-width="2">
                                                <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z" />
                                                <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z" />
                                            </svg>
                                        </div>
                                        <div>
                                            <h2>Project & Context</h2>
                                            <p>Provide project details and reference papers</p>
                                        </div>
                                    </div>

                                    <!-- Technical Context (New) -->
                                    <div class="context-zone">
                                        <label class="zone-label">Reference Paper / Abstract (Optional)</label>
                                        <div class="upload-box" id="drop-zone">
                                            <input type="file" id="base-paper" accept=".pdf,.doc,.docx" hidden>
                                            <div class="upload-content">
                                                <svg width="32" height="32" viewBox="0 0 24 24" fill="none"
                                                    stroke="currentColor" stroke-width="2">
                                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                                    <polyline points="17 8 12 3 7 8"></polyline>
                                                    <line x1="12" y1="3" x2="12" y2="15"></line>
                                                </svg>
                                                <p>Drop Reference PDF/Word or Click to Upload</p>
                                                <span>AI will analyze this file to generate grounded content</span>
                                            </div>
                                            <div id="file-status" class="hidden">
                                                <div class="status-pill">
                                                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none"
                                                        stroke="currentColor" stroke-width="2">
                                                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" />
                                                        <polyline points="22 4 12 14.01 9 11.01" />
                                                    </svg>
                                                    <span id="file-name">file.pdf</span>
                                                    <button type="button" class="btn-remove"
                                                        onclick="removeFile(event)">Ã—</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-group" style="margin-top: 1.5rem;">
                                        <label for="project-title">Project Title <span class="required">*</span></label>
                                        <input type="text" id="project-title"
                                            placeholder="e.g., Brain Tumor Detection Using Deep Learning" required>
                                        <span class="hint">Enter your project title â€” Description & Technologies will be
                                            auto-generated by AI</span>
                                    </div>

                                    <!-- Advanced AI Features (New) -->
                                    <div class="context-zone ai-features-zone">
                                        <label class="zone-label">Advanced AI Enhancements</label>
                                        <div class="ai-toggle-group">
                                            <div class="ai-toggle-item">
                                                <div class="ai-toggle-text">
                                                    <strong>AI-Generated Illustrations</strong>
                                                    <p>Automatically generate technical diagrams and photos (via DALL-E)
                                                    </p>
                                                </div>
                                                <label class="switch">
                                                    <input type="checkbox" id="toggle-ai-images" checked>
                                                    <span class="slider round"></span>
                                                </label>
                                            </div>
                                            <div class="ai-toggle-item">
                                                <div class="ai-toggle-text">
                                                    <strong>Smart Academic Search</strong>
                                                    <p>Validate and fetch real citations using Google Search API</p>
                                                </div>
                                                <label class="switch">
                                                    <input type="checkbox" id="toggle-smart-refs" checked>
                                                    <span class="slider round"></span>
                                                </label>
                                            </div>
                                            <div class="ai-toggle-item">
                                                <div class="ai-toggle-text">
                                                    <strong>Technical Equations</strong>
                                                    <p>Include complex mathematical LaTeX derivations and algorithms</p>
                                                </div>
                                                <label class="switch">
                                                    <input type="checkbox" id="toggle-equations" checked>
                                                    <span class="slider round"></span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="course-code">Course Code <span class="required">*</span></label>
                                            <input type="text" id="course-code" placeholder="e.g., CSA0708" required>
                                        </div>
                                        <div class="form-group">
                                            <label for="course-name">Course Name <span class="required">*</span></label>
                                            <input type="text" id="course-name"
                                                placeholder="e.g., Computer Networks and Web Connections" required>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="branch-name">Branch / Department <span
                                                class="required">*</span></label>
                                        <input type="text" id="branch-name" placeholder="e.g., CSE (AIDS)" required>
                                    </div>

                                    <div class="form-group">
                                        <label for="project-description">Project Description <span
                                                class="required">*</span></label>
                                        <textarea id="project-description" rows="3"
                                            placeholder="Enter detailed description. This field is mandatory."
                                            required></textarea>
                                        <span class="hint">Strictly provide your own project description. Content will
                                            be
                                            generated
                                            based on this and your project title.</span>
                                    </div>

                                    <div class="form-group" style="margin-bottom: 20px;">
                                        <label for="reference-file">Reference Template for Structure (.docx)</label>
                                        <input type="file" id="reference-file" accept=".docx"
                                            style="padding: 10px; background: hsla(240, 10%, 10%, 0.3); border: 1px dashed hsla(240, 10%, 50%, 0.3); border-radius: 8px; color: #fff; width: 100%;">
                                        <span class="hint">Upload a report ONLY to copy its Table of Contents structure.
                                            All
                                            content
                                            will be 100% NEW and generated strictly for YOUR project title.</span>
                                    </div>

                                    <div class="form-actions">
                                        <div></div>
                                        <button type="button" class="btn btn-primary" onclick="goToStep(2)"
                                            id="btn-next-1">
                                            Next Step
                                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor" stroke-width="2">
                                                <polyline points="9 18 15 12 9 6" />
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Step 2: Students -->
                            <div class="form-step" id="step-2">
                                <div class="card">
                                    <div class="card-header">
                                        <div class="card-icon">
                                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor" stroke-width="2">
                                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                                                <circle cx="9" cy="7" r="4" />
                                                <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
                                                <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                                            </svg>
                                        </div>
                                        <div>
                                            <h2>Student Details</h2>
                                            <p>Add 1â€“4 students. Grammar auto-adjusts for single student.</p>
                                        </div>
                                    </div>

                                    <div class="student-info-banner" id="grammar-banner">
                                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2">
                                            <circle cx="12" cy="12" r="10" />
                                            <path d="M12 16v-4" />
                                            <path d="M12 8h.01" />
                                        </svg>
                                        <span>Single student detected â€” grammar will auto-switch to <strong>"I /
                                                my"</strong>
                                            instead of "We / our"</span>
                                    </div>

                                    <!-- Student 1 -->
                                    <div class="student-block" id="student-1-block">
                                        <div class="student-label">
                                            <span class="student-badge">1</span>
                                            Student 1 <span class="required">*</span>
                                        </div>
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label for="student-1-name">Full Name</label>
                                                <input type="text" id="student-1-name" placeholder="e.g., John Doe"
                                                    required>
                                            </div>
                                            <div class="form-group">
                                                <label for="student-1-reg">Registration No.</label>
                                                <input type="text" id="student-1-reg"
                                                    placeholder="e.g., RA2211028010XXX" required>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Student 2 -->
                                    <div class="student-block optional" id="student-2-block">
                                        <div class="student-label">
                                            <span class="student-badge">2</span>
                                            Student 2 <span class="tag-optional">Optional</span>
                                            <button type="button" class="btn-clear" onclick="clearStudent(2)"
                                                title="Remove Student 2">
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                                                    stroke="currentColor" stroke-width="2">
                                                    <line x1="18" y1="6" x2="6" y2="18" />
                                                    <line x1="6" y1="6" x2="18" y2="18" />
                                                </svg>
                                            </button>
                                        </div>
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label for="student-2-name">Full Name</label>
                                                <input type="text" id="student-2-name" placeholder="e.g., Jane Smith">
                                            </div>
                                            <div class="form-group">
                                                <label for="student-2-reg">Registration No.</label>
                                                <input type="text" id="student-2-reg"
                                                    placeholder="e.g., RA2211028010XXX">
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Student 3 -->
                                    <div class="student-block optional" id="student-3-block">
                                        <div class="student-label">
                                            <span class="student-badge">3</span>
                                            Student 3 <span class="tag-optional">Optional</span>
                                            <button type="button" class="btn-clear" onclick="clearStudent(3)"
                                                title="Remove Student 3">
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                                                    stroke="currentColor" stroke-width="2">
                                                    <line x1="18" y1="6" x2="6" y2="18" />
                                                    <line x1="6" y1="6" x2="18" y2="18" />
                                                </svg>
                                            </button>
                                        </div>
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label for="student-3-name">Full Name</label>
                                                <input type="text" id="student-3-name" placeholder="e.g., Bob Wilson">
                                            </div>
                                            <div class="form-group">
                                                <label for="student-3-reg">Registration No.</label>
                                                <input type="text" id="student-3-reg"
                                                    placeholder="e.g., RA2211028010XXX">
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Student 4 -->
                                    <div class="student-block optional" id="student-4-block">
                                        <div class="student-label">
                                            <span class="student-badge">4</span>
                                            Student 4 <span class="tag-optional">Optional</span>
                                            <button type="button" class="btn-clear" onclick="clearStudent(4)"
                                                title="Remove Student 4">
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                                                    stroke="currentColor" stroke-width="2">
                                                    <line x1="18" y1="6" x2="6" y2="18" />
                                                    <line x1="6" y1="6" x2="18" y2="18" />
                                                </svg>
                                            </button>
                                        </div>
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label for="student-4-name">Full Name</label>
                                                <input type="text" id="student-4-name" placeholder="e.g., Alice Brown">
                                            </div>
                                            <div class="form-group">
                                                <label for="student-4-reg">Registration No.</label>
                                                <input type="text" id="student-4-reg"
                                                    placeholder="e.g., RA2211028010XXX">
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-actions">
                                        <button type="button" class="btn btn-ghost" onclick="goToStep(1)">
                                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor" stroke-width="2">
                                                <polyline points="15 18 9 12 15 6" />
                                            </svg>
                                            Back
                                        </button>
                                        <button type="button" class="btn btn-primary" onclick="goToStep(3)"
                                            id="btn-next-2">
                                            Next Step
                                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor" stroke-width="2">
                                                <polyline points="9 18 15 12 9 6" />
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Step 3: Guide & Dates -->
                            <div class="form-step" id="step-3">
                                <div class="card">
                                    <div class="card-header">
                                        <div class="card-icon">
                                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor" stroke-width="2">
                                                <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
                                                <line x1="16" y1="2" x2="16" y2="6" />
                                                <line x1="8" y1="2" x2="8" y2="6" />
                                                <line x1="3" y1="10" x2="21" y2="10" />
                                            </svg>
                                        </div>
                                        <div>
                                            <h2>Guide & Dates</h2>
                                            <p>Supervisor details and submission timeline</p>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="guide-name">Guide / Supervisor Name <span
                                                class="required">*</span></label>
                                        <input type="text" id="guide-name" placeholder="e.g., Dr. A. Kumar" required>
                                    </div>

                                    <div class="form-group">
                                        <label for="guide-designation">Guide Designation <span
                                                class="required">*</span></label>
                                        <input type="text" id="guide-designation"
                                            placeholder="e.g., Associate Professor" required>
                                    </div>

                                    <div class="form-group">
                                        <label for="program-director">Program Director Name <span
                                                class="required">*</span></label>
                                        <input type="text" id="program-director" placeholder="e.g., Dr. B. Sharma"
                                            required>
                                    </div>

                                    <div class="form-group">
                                        <label for="department-name">Department Full Name <span
                                                class="required">*</span></label>
                                        <input type="text" id="department-name"
                                            placeholder="e.g., Computer Science and Engineering (AI & DS)" required>
                                    </div>

                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="submission-date">Submission Date <span
                                                    class="required">*</span></label>
                                            <input type="text" id="submission-date" placeholder="e.g., August 2025"
                                                required>
                                        </div>
                                        <div class="form-group">
                                            <label for="viva-date">Viva Date <span class="required">*</span></label>
                                            <input type="text" id="viva-date" placeholder="e.g., 20th August 2025"
                                                required>
                                        </div>
                                    </div>

                                    <div class="form-actions">
                                        <button type="button" class="btn btn-ghost" onclick="goToStep(2)">
                                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor" stroke-width="2">
                                                <polyline points="15 18 9 12 15 6" />
                                            </svg>
                                            Back
                                        </button>
                                        <button type="button" class="btn btn-generate" onclick="generateDocument()"
                                            id="btn-generate">
                                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor" stroke-width="2">
                                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                                                <polyline points="14 2 14 8 20 8" />
                                                <line x1="16" y1="13" x2="8" y2="13" />
                                                <line x1="16" y1="17" x2="8" y2="17" />
                                            </svg>
                                            Generate Document
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </section>

                    <!-- Output Section -->
                    <section class="output-section hidden" id="output-section">
                        <div class="output-header">
                            <h2>
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" />
                                    <polyline points="22 4 12 14.01 9 11.01" />
                                </svg>
                                Generated Front Pages
                            </h2>
                            <div class="output-actions">
                                <button class="btn btn-outline" onclick="copyAll()" id="btn-copy-all">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2" />
                                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
                                    </svg>
                                    Copy All
                                </button>
                                <button class="btn btn-outline" onclick="downloadDocx()" id="btn-download">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                                        <polyline points="7 10 12 15 17 10" />
                                        <line x1="12" y1="15" x2="12" y2="3" />
                                    </svg>
                                    Download Full Report (.docx)
                                </button>
                                <button class="btn btn-ghost" onclick="editForm()" id="btn-edit">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" />
                                        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" />
                                    </svg>
                                    Edit Details
                                </button>
                            </div>
                        </div>

                        <!-- Full Report Info Banner -->
                        <div class="report-info-banner" id="report-info-banner">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                <polyline points="14 2 14 8 20 8"></polyline>
                                <line x1="16" y1="13" x2="8" y2="13"></line>
                                <line x1="16" y1="17" x2="8" y2="17"></line>
                            </svg>
                            <div>
                                <strong>30-Page Academic Report</strong> â€” AI-powered with Fact Extraction Engine.
                                10 chapters Ã— 3 sections each, with domain-specific content.
                                Includes: TOC, Abstract, Chapters (Introduction â†’ References), and 15 APA references.
                            </div>
                        </div>

                        <!-- Grammar Notification -->
                        <div class="grammar-notification" id="grammar-notification">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" />
                                <polyline points="22 4 12 14.01 9 11.01" />
                            </svg>
                            <span id="grammar-notification-text"></span>
                        </div>

                        <!-- Title Page Output -->
                        <div class="output-card" id="output-title-page">
                            <div class="output-card-label">
                                <span class="output-badge">Page 1</span>
                                Title Page
                                <button class="btn-copy-section" onclick="copySection('title-page-content')"
                                    title="Copy this section">
                                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2" />
                                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
                                    </svg>
                                </button>
                            </div>
                            <div class="output-content" id="title-page-content"></div>
                        </div>

                        <!-- Declaration Output -->
                        <div class="output-card" id="output-declaration">
                            <div class="output-card-label">
                                <span class="output-badge">Page 2</span>
                                Declaration
                                <button class="btn-copy-section" onclick="copySection('declaration-content')"
                                    title="Copy this section">
                                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2" />
                                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
                                    </svg>
                                </button>
                            </div>
                            <div class="output-content" id="declaration-content"></div>
                        </div>

                        <!-- Certificate Output -->
                        <div class="output-card" id="output-certificate">
                            <div class="output-card-label">
                                <span class="output-badge">Page 3</span>
                                Bonafide Certificate
                                <button class="btn-copy-section" onclick="copySection('certificate-content')"
                                    title="Copy this section">
                                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2" />
                                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
                                    </svg>
                                </button>
                            </div>
                            <div class="output-content" id="certificate-content"></div>
                        </div>

                        <!-- Acknowledgement Output -->
                        <div class="output-card" id="output-acknowledgement">
                            <div class="output-card-label">
                                <span class="output-badge">Page 4</span>
                                Acknowledgement
                                <button class="btn-copy-section" onclick="copySection('acknowledgement-content')"
                                    title="Copy this section">
                                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2" />
                                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
                                    </svg>
                                </button>
                            </div>
                            <div class="output-content" id="acknowledgement-content"></div>
                        </div>
                    </section>
                    <footer class="app-footer">
                        <div class="footer-content">
                            <div class="footer-dev">Developed by <span>Tharunkumar.S - ALPHA GRIDZ COMMUNITY</span>
                            </div>
                            <div class="footer-contact">Contact: tharunkumarjee@gmail.com</div>
                            <div class="footer-powered">Powered by <strong>ALPHA GRIDZ</strong></div>
                        </div>
                    </footer>
                    <!-- Right Pane: Live Document Preview -->
                    <aside class="preview-pane" id="preview-pane">
                        <div class="preview-toolbar">
                            <div class="preview-title">Live Document Preview</div>
                            <div class="preview-stats">
                                <span id="stat-pages">0 Pages</span>
                                <span class="sep">â€¢</span>
                                <span id="stat-words">0 Words</span>
                            </div>
                        </div>
                        <div class="preview-canvas" id="preview-canvas">
                            <div class="preview-empty">
                                <div class="pulse-icon">
                                    <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <path d="M12 2v20M2 12h20M12 2l4 4-4-4-4 4"></path>
                                    </svg>
                                </div>
                                <p>Fill in details and start generation to see the live document</p>
                            </div>
                        </div>
                    </aside>
            </div>

        </div>

        <!-- Hidden Mermaid Rendering Helper -->
        <div id="mermaid-render-helper" style="position: absolute; left: -9999px; top: -9999px;"></div>

        <!-- Docx generation libraries -->
        <script src="https://unpkg.com/docx@9.0.2/build/index.umd.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
        <!-- Feedback Modal -->
        <div id="feedback-modal" class="modal-overlay hidden">
            <div class="modal-card">
                <div class="modal-header">
                    <h2>Generation Complete! ðŸš€</h2>
                    <p>How would you rate your experience with v1.0?</p>
                </div>
                <div class="rating-stars">
                    <span class="star" data-value="5">â˜…</span>
                    <span class="star" data-value="4">â˜…</span>
                    <span class="star" data-value="3">â˜…</span>
                    <span class="star" data-value="2">â˜…</span>
                    <span class="star" data-value="1">â˜…</span>
                </div>
                <textarea id="feedback-text" placeholder="Tell us how we can improve..."></textarea>
                <div class="modal-actions">
                    <button class="btn btn-secondary" onclick="closeFeedback()">Skip</button>
                    <button class="btn btn-primary" onclick="submitFeedback()">Submit Feedback</button>
                </div>
            </div> <!-- End workstation-view -->
        </div> <!-- End app-shell -->
        <!-- Footer -->
        <footer class="app-footer">
            <div class="footer-content">
                <div class="footer-left">
                    <h3>SIMATS Engineering</h3>
                    <p>Capstone Workstation v1.0</p>
                </div>
                <div class="footer-center">
                    <p>Empowering Academic Excellence Through AI</p>
                </div>
                <div class="footer-right">
                    <p>&copy; 2026 Institutional Workstation. All Rights Reserved.</p>
                </div>
            </div>
        </footer>

        <!-- Toast System -->
        <div id="toast" class="toast hidden">
            <div class="toast-content">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"></path>
                    <path d="M12 8v4"></path>
                    <path d="M12 16h.01"></path>
                </svg>
                <span id="toast-message"></span>
            </div>
        </div>

        <!-- Logic Scripts -->
        <script type="module" src="./logo_data.js?v=4.0.1"></script>
        <script type="module" src="./content_generator.js?v=4.0.1"></script>
        <script type="module" src="./script.js?v=4.0.1"></script>
        <script type="module" src="./docx_export.js?v=4.0.1"></script>
</body>

</html>